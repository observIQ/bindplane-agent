receivers:
  filelog:
    include:
        # {{ range $fp := .logs_directory }}
        - '{{ $fp }}/{{ .filename }}'
        # {{end}}
    exclude:
        # {{ range $fp := .logs_directory }}
          - '{{ $fp }}/nameserver_history*.trc'
          - '{{ $fp }}/nameserver*loads*.trc'
          - '{{ $fp }}/nameserver*unloads*.trc'
          - '{{ $fp }}/nameserver*executed_statements*.trc'
        # {{end}}
    multiline:
      line_start_pattern: '\[\d+\]{[^}]+}\[[^\/]+\/[^\]]+\] \d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+ [^ ]+ [^ ]+\s+[^ ]+ :'
    start_at: {{ .start_at }}
    attributes:
      log_type: sap_hana
    operators:
      - id: sap_hana_parser
        type: regex_parser
        regex: '^\[(?P<thread_id>\d+)\]{(?P<connection_id>[^}]+)}\[(?P<transaction_id>[^\/]+)\/(?P<update_transaction_id>[^\]]+)\] (?P<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+) (?P<sap_severity>[^ ]+) (?P<component>[^ ]+)\s+(?P<source_file>[^ ]+) : (?P<message>.*)'
        timestamp:
          parse_from: attributes.timestamp
          layout: '%Y-%m-%d %H:%M:%S.%s'
        severity:
          parse_from: attributes.sap_severity
          mapping:
            debug: d
            info: i
            warn: w
            error: e
            fatal: f

service:
  pipelines:
    logs:
      receivers: [filelog] 


